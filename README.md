# Matrix

## Описание
Проект отображает список товаров, которые необходимо выставить в мебельных
салонах компании Euromebel, с возможностью контроля, комментирования и 
отслеживания статусов комментариев.

Проект разделён на несколько частей: 
- Первая версия использует стандартный шаблонизатор django для отрисовки
моделей
- Вторя версия разделяет проект на Frontend и Backend, с настройкой REST API
## Установка и развёртывание проекта

### 1. Клонирование репозитория
Клонируйте проект на своё устройство:

```bash
git clone https://github.com/"Ваш никнейм"/furniture_store_analytics.git
cd furniture_store_analytics
```
### 2. Установка и активация виртуального окружения
Создайте виртуальное окружение и активируйте его. Используйте команду,
соответствующую вашей ОС:

#### Для Windows:
`python -m venv venv
venv\Scripts\activate`

#### Для macOS/Linux:
`python3 -m venv venv
source venv/bin/activate`

### 3. Установка зависимостей
Установите необходимые зависимости из файла requirements.txt:

`pip install -r requirements.txt`

### 4. Заполнение .env файла
Для этого необходимо заполнить ключевые параметры из .env_EXAMPLE и 
переименовать его в .env

### 5. Применение миграций
Примените миграции для создания всех необходимых таблиц в базе данных:

`python manage.py migrate`

### 6. Создание суперпользователя (опционально)
Если вам нужен доступ к административной панели, создайте суперпользователя:

`python manage.py createsuperuser`

### 6. Запуск сервера разработки
Запустите сервер разработки для проверки работы приложения:

`python manage.py runserver`

Теперь приложение доступно по адресу: http://127.0.0.1:8000/



## Основные конечные точки API
### Products
#### Запрос
- **GET** `/api/v1/products/` - получение списка продуктов, их кол-во на складе, кол-во комментариев
- **GET** `/api/v1/products/?matrix=True&stores=1,2,6&room_class=Г 6,Г 7` - Поиск товара по ключевым значениям
- **PATCH** `/api/v1/products/<product_article>` - Обновление товара. Возможные поля для именения: **room_class**

**Возможные параметры фильтрации:**

- `matrix` (bool): Фильтрация по матрице. Принимает значения `True` или `False`.
- `stores` (list[int]): Список идентификаторов магазинов через запятую. Например, `1,2,6`.
- `room_class` (list[string]): Список классов комнат через запятую. Например, `Г 6,Г 7`.

**Пример:**

```request
GET /api/v1/products/
```
```json

{
   "count": 1,
    "next": "string",
    "previous": "string",
    "results": [
      {
        "article": "43159990",
        "name": "Стол - кухонный",
        "model": "Алена",
        "manufacturer": "Империал",
        "square": "0.746532",
        "segment": "Шкаф четырехдверный",
        "matrix": "Матрица",
        "room_class": "Г 6",
        "category": "СПАЛЬНЯ",
        "warehouses": {
          "АЛА склад": 2,
          "ПВД склад": 5,
          "ШМК склад": 7
        },
        "stores": {
          "АЛА ЕвроКомплект МС": {
            "plan": 1,
            "fact": 3,
            "comments_count": 3
          },
          "АЛА ЕвроМебель МС": {
            "plan": 3,
            "fact": 1,
            "comments_count": 0
          }
        }
      }
    ]
}
```
### Warehouses
#### Запросы
- **GET** `/api/v1/warehouses/` - получение списка складов
#### Пример ответа
```
GET /api/v1/warehouses/
```

```json
{

    "count": 2,
    "next": "string",
    "previous": "string",
    "results": [
        {
            "id": 1,
            "name": "ПВД Склады"
        },
        {
            "id": 2,
            "name": "АЛА Склады"
        }
    ]
}
```
### Stores
#### Запрос
- **GET** `/api/v1/stores/` - получение списка магазинов
#### Пример ответа
```
GET /api/v1/stores/
```

```json
{

    "count": 2,
    "next": "string",
    "previous": "string",
    "results": [
        {
            "id": 1,
            "name": "АЛА ЕвроКомплект МС",
            "info": "Спальни\t15\t15\n   Гостиные\t22\t22\n   Детские\t4\t4\n   Шкафы\t9\t5\n   Прихожие\t7\t7\n"
        },
        {
            "id": 2,
            "name": "АЛА ЕвроМебель МС",
            "info": "Спальни\t16\t16\n   Гостиные\t21\t22\n   Детские\t0\t4\n   Шкафы\t0\t5\n   Прихожие\t1\t7\n"
        }
    ]
}
```

### Comments
#### Запросы
- **GET** `/api/v1/comments/` - получение списка комментариев
- **GET** `/api/v1/comments/{comment_id}` - получение определенного комментария
комментариев
- **GET** `/api/v1/comments/{store_id}/{product_article}` - получение списка
комментариев по магазину и определенному товару
- **POST** `/api/v1/comments/{store_id}/{product_article}` - создание нового
комментария
- **PATCH** `/api/v1/comments/{comment_id}` - Измненение комментария. Может
производится только автором комментария.
  - Комментарии имеют лишь 3 возможных статуса: "Не выполнено", "В работе",
  "Выполнено". Другие значения при передаче status будут вызывать ошибку
#### Пример запроса
```
GET /api/v1/comments/
```
#### Пример ответа
```json
{

    "count": 2,
    "next": "string",
    "previous": "string",
    "results": [
        {
            "id": 1,
            "text": "Избавить от выставки",
            "created_at": "2024-08-02 15:06:14.588 +0500",
            "finish_planned_date": "2024-08-26 05:00:00.000 +0500",
            "status": "Выполнено",
            "author": "Ponomarenko.M",
            "product_article": "0001234",
            "store": "АЛА ЕвроКомплект МС"
          
        },
 {
            "id": 2,
            "text": "Добавить от выставку",
            "created_at": "2024-08-02 15:06:14.588 +0500",
            "finish_planned_date": "2024-08-26 05:00:00.000 +0500",
            "status": "Не выполнено",
            "author": "Ponomarenko.M",
            "product_article": "0004321",
            "store": "АЛА ЕвроКомплект МС"
        }
    ]
}
```
#### Пример запроса
```
POST /api/v1/comments/2/00001234
application/json
{
    "text": "Что с выставкой?",
    "finish_planned_date": "2024-09-06 05:00:00.000 +0500"
}
```
#### Пример ответа
```json
{
    "id": 1,
    "text": "Что с выставкой?",
    "finish_planned_date": "2024-09-06 05:00:00.000 +0500",
    "status": "Не выполнено"
}
```
#### Пример запроса
```
PATCH /api/v1/comments/{comment_id}
application/json
{
    "status": "Выполнено"
}
```
#### Пример ответа
```json
{
    "id": 1,
    "text": "Что с выставкой?",
    "finish_planned_date": "2024-09-06 05:00:00.000 +0500",
    "status": "Выполнено"
}
```


